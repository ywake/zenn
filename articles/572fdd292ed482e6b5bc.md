---
title: "Flutter„ÅÆ„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„ÅßFirebase„Å®ÈÄö‰ø°(iOS)"
emoji: "üî•"
type: "tech" # tech: ÊäÄË°ìË®ò‰∫ã / idea: „Ç¢„Ç§„Éá„Ç¢
topics: ["Flutter", "Firebase"]
published: true
---

# „ÇÑ„Çä„Åü„Åã„Å£„Åü„Åì„Å®
* [Workmanager](https://pub.dev/packages/workmanager)„Çí‰Ωø„Å£„Å¶Flutter„ÅÆ„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„ÉâÂá¶ÁêÜ„ÇíÂÆüË£Ö
@[card](https://medium.com/vrt-digital-studio/flutter-workmanager-81e0cfbd6f6e)
* „Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„ÉâÂá¶ÁêÜ„Åß„ÅØFirebase„Å®ÈÄö‰ø°
* (SwiftÁü•Ë≠ò„Å™„Åó)

# „ÇÑ„Å£„Åü„Åì„Å®
* „Ç≥„Éº„Éâ„ÅØ[ÂÖ¨Âºè„ÅÆË™¨Êòé](https://github.com/fluttercommunity/flutter_workmanager/blob/master/IOS_SETUP.md)„Å©„Åä„Çä
```dart:main.dart
void main() {
	// ...(Áï•)
	Workmanager().initialize(
		callbackDispatcher,
		isInDebugMode: true,
	);
	runApp(new MyApp());
}

void callbackDispatcher() {
  Workmanager().executeTask((taskName, inputData) async {
    switch (taskName) {
      case Workmanager.iOSBackgroundTask:
        await Firebase.initializeApp();
        Firebase.doSomething(); // Firestore„Å®ÈÄö‰ø°
        break;
    }
    bool success = true;
    return Future.value(success);
  });
}
```

```swift:AppDelegate.swift
import UIKit
import Flutter
import Firebase

@UIApplicationMain
@objc class AppDelegate: FlutterAppDelegate {
  override func application(
    _ application: UIApplication,
    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
  ) -> Bool {
    FirebaseApp.configure()
    GeneratedPluginRegistrant.register(with: self)
    UIApplication.shared.
    setMinimumBackgroundFetchInterval(TimeInterval(60*15)) // <- ËøΩÂä†
    return super.application(application, didFinishLaunchingWithOptions: launchOptions)
  }
}
```

# ÊÇ©„Åæ„Åï„Çå„Åü„Ç®„É©„Éº
:::message alert
MissingPluginException (No implementation found for method Firebase#initializeCore on channel plugins.flutter.io/firebase_core)
:::
‰∏ÄÂøúÂÖ¨Âºè„ÅÆË™¨Êòé„Å´„Éó„É©„Ç∞„Ç§„É≥„ÅÆÂ∞éÂÖ•„Å´„Å§„ÅÑ„Å¶„ÅÆË™¨Êòé„ÅØ„ÅÇ„Çä„Åæ„Åô„ÄÇ[„Åì„Å°„Çâ](https://github.com/fluttercommunity/flutter_workmanager/blob/master/IOS_SETUP.md#registered-plugins)
„Åó„Åã„Åó„ÄÅ`import workmanager`„ÅÆË™¨Êòé„ÅåÊäú„Åë„Å¶„ÅÑ„Å¶
:::message alert
Cannot find 'WorkmanagerPlugin' in scope
:::
„Å®„Å™„Å£„Åü„Çä„ÄÅ
„Åù„Çå„ÇíÁõ¥„Åó„Å¶„ÇÇ
:::message alert
Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Duplicate plugin key: FLTFirebaseFirestorePlugin'
:::
„Å®„Å™„Å£„Åü„Çä„ÄÅ„ÄÅ„ÄÅÔºàÁßÅ„ÅåËã±Ë™û„Çí„Å°„ÇÉ„Çì„Å®Ë™≠„Çì„Åß„Å™„ÅÑ„ÅÆ„ÅåÂéüÂõ†„Åã„ÇÇÔºâ

„Åß„Ç§„É≥„Çø„Éº„Éç„ÉÉ„Éà„ÅÆÊµ∑„ÇíÂΩ∑Âæ®„Å£„Å¶„ÅÑ„Åü„Çì„Åß„Åô„Åå„ÄÅissues„ÅÆËô±ÊΩ∞„Åó„ÇíÂßã„ÇÅ„Åü„ÇâËß£Ê±∫Á≠ñ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åó„Åü„ÄÇ

# ÁµêË´ñ
* `AppDelegate.swift`„ÅÆ„Ç®„É©„Éº„ÅÆ„Åß„Å™„ÅÑÊõ∏„ÅçÊñπ„ÇíË¶ã„Å§„Åë„Åæ„Åó„Åü„ÄÇ
* https://github.com/fluttercommunity/flutter_workmanager/issues/226#issuecomment-739531502

```swift:AppDelegate.swift
import UIKit
import Flutter
import Firebase
import workmanager

@UIApplicationMain
@objc class AppDelegate: FlutterAppDelegate {
  override func application(
    _ application: UIApplication,
    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
  ) -> Bool {
    FirebaseApp.configure()
    GeneratedPluginRegistrant.register(with: self)
    UIApplication.shared.setMinimumBackgroundFetchInterval(TimeInterval(60*15))
    // ‚ñº „Åì„Çå
    WorkmanagerPlugin.setPluginRegistrantCallback { registry in
      GeneratedPluginRegistrant.register(with: registry)
    }
    return super.application(application, didFinishLaunchingWithOptions: launchOptions)
  }
}
```

![](https://storage.googleapis.com/zenn-user-upload/2atl79q2ekjqb6ojj0w4xdd6pk18)
